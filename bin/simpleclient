#!/usr/bin/perl

use strict;
use warnings;
use 5.10.0;

# standard modules
use Data::Dumper;
use FindBin;

# JobCenter
use lib "$FindBin::Bin/../lib";
use JobCenter::SimpleClient;

exit main(@ARGV);

sub main {
	if (scalar @_ != 2) {
		die "usage: $0 <wfname> <jsonblob>";
	}

	my ($wfname, $inargs) = @_;

	my $client = JobCenter::SimpleClient->new(
		cfgpath => "$FindBin::Bin/../etc/jobcenter.conf",
		debug => 1,
	);
	
	die 'no client?' unless $client;

	my $res = $client->call($wfname, $inargs);

	if ($res) {
		say 'result: ', $res;
	} else {
		say 'no result?';
	}
	return 0;
}

=encoding utf8

=head1 NAME

simpleclient - a JobCenter::SimpleClient example

=head1 SYNOPSIS

  Usage: simpleclient [workflow] [inargs]
	
  simpleclient calltest '{input => 123.456}'

=head1 DESCRIPTION

Calls the named workflow with the input arguments given as a JSON string

=head1 SEE ALSO

L<Jobcenter::SimpleClient>, L<simpleclient2>.

=cut

